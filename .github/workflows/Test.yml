name: Test

on:
    workflow_dispatch:
        inputs:
            is_minor_branch:
                description: 'Is Minor Branch'
                required: true
                default: 'false'
                type: choice
                options:
                    - 'true'
                    - 'false'

jobs:
  Test:
    runs-on: windows-latest
    env:
        SKIPSTAGE: 'false'  # Initial value set at the start

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4

    - name: Clean workspace
      run: Remove-Item -Recurse -Force *.* -ErrorAction Ignore

    - name: Validate User Input
      run: |
        if ("${{ github.event.inputs.is_minor_branch }}" -eq "true") {
          echo "SKIPSTAGE=true" >> $GITHUB_ENV
        }
        echo "SKIPSTAGE=${{ env.SKIPSTAGE }}"

    - name: Printing Skip stage
      run: |
        Write-Host "SKIPSTAGE: $env:SKIPSTAGE"
    
    - name: Skip Stage
      if: ${{ env.SKIPSTAGE == 'false' }}
      run: Write-Host "SUCCESS"
